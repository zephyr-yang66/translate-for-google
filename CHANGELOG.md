# 更新日志

## [2.0.0] - 2025-11-07

### 🔐 安全改进

#### **重大变更：API 密钥不再硬编码**
- ⚠️ **破坏性变更**：移除所有硬编码的 API 密钥
- ✅ API 密钥现在安全存储在 `chrome.storage.sync` 中
- ✅ 用户需要在配置页面自行配置密钥
- ✅ 首次安装自动打开配置页面引导用户

#### **请求频率限制**
- ✅ 新增请求频率限制器
  - 每分钟最多 30 次请求
  - 每小时最多 500 次请求
- ✅ 防止 API 滥用，保护用户账户安全

#### **翻译缓存机制**
- ✅ 智能缓存系统
  - 相同文本不重复调用 API
  - 缓存有效期：7 天
  - 最大缓存：1000 条记录
  - 自动清理过期缓存
- ✅ 大幅减少 API 调用次数，节省成本

### 🌟 新功能

#### **多 API 支持**
- ✅ 百度翻译 API（推荐）
  - 每月 200 万字符免费
  - 翻译质量优秀
  - 速度快
- ✅ LibreTranslate API（完全免费）
  - 无使用限制
  - 开源方案
  - 无需注册
- ✅ DeepSeek AI（付费）
  - 翻译质量最好
  - 约 ¥0.002/次

#### **智能备用方案**
- ✅ 主 API 失败自动切换到备用 API
- ✅ 按优先级依次尝试多个 API
- ✅ 提高服务可用性

#### **配置页面**
- ✅ 美观的配置界面
- ✅ 支持多 API 配置
- ✅ 实时测试连接
- ✅ 输入验证和错误提示
- ✅ 高级选项（缓存、备用方案）

### 🎨 用户体验改进

#### **更好的错误处理**
- ✅ 友好的错误提示消息
- ✅ 详细的错误分类
- ✅ 常见错误码解释

#### **性能优化**
- ✅ 缓存命中时响应速度接近即时
- ✅ 减少不必要的 API 调用
- ✅ 更流畅的用户体验

### 🔧 技术改进

#### **代码结构优化**
- ✅ 新增 `TranslationManager` 类统一管理翻译
- ✅ 新增 `TranslationCache` 类管理缓存
- ✅ 新增 `RateLimiter` 类控制请求频率
- ✅ 模块化的 API 集成

#### **安全加固**
- ✅ 输入验证
- ✅ 文本长度限制（5000 字符）
- ✅ API 密钥格式验证
- ✅ 请求频率限制

#### **构建配置**
- ✅ 新增 options 页面构建配置
- ✅ 自动复制 HTML 文件到 dist

### 📚 文档更新

- ✅ 新增 `SECURITY_GUIDE.md` - 安全使用指南
- ✅ 新增 `CHANGELOG.md` - 更新日志
- ✅ 更新 `README.md` - 添加配置说明

### 🗑️ 移除

- ❌ 移除硬编码的 API 密钥（安全考虑）
- ❌ 移除 `CONFIG.API_KEY`（迁移到用户配置）

---

## [1.0.0] - 2025-11-06

### 初始版本

- ✅ 基础翻译功能
- ✅ 右键菜单集成
- ✅ 侧边抽屉 UI
- ✅ DeepSeek API 集成
- ✅ 英译中支持

---

## 迁移指南

### 从 1.x 升级到 2.0

#### ⚠️ 重要变更

1. **必须配置 API 密钥**
   - 旧版本使用硬编码密钥（不安全）
   - 新版本要求用户自行配置密钥
   - 首次安装会自动打开配置页面

2. **推荐使用免费 API**
   - 百度翻译：每月 200 万字符免费
   - LibreTranslate：完全免费
   - DeepSeek：付费，不推荐作为主要方案

#### 📋 升级步骤

1. **卸载旧版本**（可选）
   ```
   chrome://extensions/
   ```

2. **安装新版本**
   - 重新构建：`npm run build`
   - 加载 `dist` 目录

3. **配置 API 密钥**
   - 打开配置页面
   - 选择翻译服务（推荐百度翻译）
   - 填写 API 密钥
   - 测试并保存

4. **启用高级功能**
   - ✅ 启用翻译缓存
   - ✅ 启用 API 备用方案

#### 💡 推荐配置

```
主 API: 百度翻译
备用 API: LibreTranslate
✅ 启用缓存
✅ 启用备用方案
```

---

## 未来计划

### v2.1.0（计划中）

- [ ] 支持更多语言对（中译英、日译中等）
- [ ] 翻译历史记录功能
- [ ] 一键复制译文
- [ ] 快捷键支持
- [ ] 深色模式

### v2.2.0（计划中）

- [ ] 自定义抽屉位置
- [ ] 语音朗读功能
- [ ] 翻译质量评分
- [ ] 使用统计面板

---

**感谢您的使用！如有问题请反馈。** 🙏

